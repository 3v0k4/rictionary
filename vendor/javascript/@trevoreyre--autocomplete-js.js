// @trevoreyre/autocomplete-js@3.0.3 downloaded from https://ga.jspm.io/npm:@trevoreyre/autocomplete-js@3.0.3/dist/autocomplete.esm.js

function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPrimitive(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:t+""}var e=function matches(e,t){return e.matches?e.matches(t):e.msMatchesSelector?e.msMatchesSelector(t):e.webkitMatchesSelector?e.webkitMatchesSelector(t):null};var t=function closestPolyfill(t,n){var i=t;while(i&&i.nodeType===1){if(e(i,n))return i;i=i.parentNode}return null};var n=function closest(e,n){return e.closest?e.closest(n):t(e,n)};var i=function isPromise(e){return Boolean(e&&typeof e.then==="function")};var o=_createClass((function AutocompleteCore(){var e=this;var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=t.search,r=t.autoSelect,s=r!==void 0&&r,l=t.setValue,u=l===void 0?function(){}:l,a=t.setAttribute,d=a===void 0?function(){}:a,c=t.onUpdate,h=c===void 0?function(){}:c,p=t.onSubmit,f=p===void 0?function(){}:p,v=t.onShow,b=v===void 0?function(){}:v,y=t.autocorrect,m=y!==void 0&&y,L=t.onHide,P=L===void 0?function(){}:L,g=t.onLoading,_=g===void 0?function(){}:g,w=t.onLoaded,R=w===void 0?function(){}:w,S=t.submitOnEnter,x=S!==void 0&&S;_classCallCheck(this,AutocompleteCore);_defineProperty(this,"value","");_defineProperty(this,"searchCounter",0);_defineProperty(this,"results",[]);_defineProperty(this,"selectedIndex",-1);_defineProperty(this,"selectedResult",null);_defineProperty(this,"destroy",(function(){e.search=null;e.setValue=null;e.setAttribute=null;e.onUpdate=null;e.onSubmit=null;e.autocorrect=null;e.onShow=null;e.onHide=null;e.onLoading=null;e.onLoaded=null}));_defineProperty(this,"handleInput",(function(t){var n=t.target.value;e.updateResults(n);e.value=n}));_defineProperty(this,"handleKeyDown",(function(t){var n=t.key;switch(n){case"Up":case"Down":case"ArrowUp":case"ArrowDown":var i=n==="ArrowUp"||n==="Up"?e.selectedIndex-1:e.selectedIndex+1;t.preventDefault();e.handleArrows(i);break;case"Tab":e.selectResult();break;case"Enter":var o=t.target.getAttribute("aria-activedescendant").length>0;e.selectedResult=e.results[e.selectedIndex]||e.selectedResult;e.selectResult();if(e.submitOnEnter)e.selectedResult&&e.onSubmit(e.selectedResult);else if(o)t.preventDefault();else{e.selectedResult&&e.onSubmit(e.selectedResult);e.selectedResult=null}break;case"Esc":case"Escape":e.hideResults();e.setValue();break;default:return}}));_defineProperty(this,"handleFocus",(function(t){var n=t.target.value;e.updateResults(n);e.value=n}));_defineProperty(this,"handleBlur",(function(){e.hideResults()}));_defineProperty(this,"handleResultMouseDown",(function(e){e.preventDefault()}));_defineProperty(this,"handleResultClick",(function(t){var i=t.target;var o=n(i,"[data-result-index]");if(o){e.selectedIndex=parseInt(o.dataset.resultIndex,10);var r=e.results[e.selectedIndex];e.selectResult();e.onSubmit(r)}}));_defineProperty(this,"handleArrows",(function(t){var n=e.results.length;e.selectedIndex=(t%n+n)%n;e.onUpdate(e.results,e.selectedIndex)}));_defineProperty(this,"selectResult",(function(){var t=e.results[e.selectedIndex];t&&e.setValue(t);e.hideResults()}));_defineProperty(this,"updateResults",(function(t){var n=++e.searchCounter;e.onLoading();e.search(t).then((function(t){if(n===e.searchCounter){e.results=t;e.onLoaded();if(e.results.length!==0){e.selectedIndex=e.autoSelect?0:-1;e.onUpdate(e.results,e.selectedIndex);e.showResults()}else e.hideResults()}}))}));_defineProperty(this,"showResults",(function(){e.setAttribute("aria-expanded",true);e.onShow()}));_defineProperty(this,"hideResults",(function(){e.selectedIndex=-1;e.results=[];e.setAttribute("aria-expanded",false);e.setAttribute("aria-activedescendant","");e.onUpdate(e.results,e.selectedIndex);e.onHide()}));_defineProperty(this,"checkSelectedResultVisible",(function(t){var n=t.querySelector('[data-result-index="'.concat(e.selectedIndex,'"]'));if(n){var i=t.getBoundingClientRect();var o=n.getBoundingClientRect();o.top<i.top?t.scrollTop-=i.top-o.top:o.bottom>i.bottom&&(t.scrollTop+=o.bottom-i.bottom)}}));this.search=i(o)?o:function(e){return Promise.resolve(o(e))};this.autoSelect=s;this.setValue=u;this.setAttribute=d;this.onUpdate=h;this.onSubmit=f;this.autocorrect=m;this.onShow=b;this.onHide=P;this.onLoading=_;this.onLoaded=R;this.submitOnEnter=x}));var r=0;var s=function uniqueId(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return"".concat(e).concat(++r)};var l=function getRelativePosition(e,t){var n=e.getBoundingClientRect();var i=t.getBoundingClientRect();var o=n.bottom+i.height>window.innerHeight&&window.innerHeight-n.bottom<n.top&&window.pageYOffset+n.top-i.height>0;return o?"above":"below"};var u=function debounce(e,t,n){var i;return function executedFunction(){var n=this;var o=arguments;var r=function later(){i=null;e.apply(n,o)};clearTimeout(i);i=setTimeout(r,t)}};
/**
 * @typedef {Object} LabelObj
 * @property {string} attribute - `aria-label` | `aria-labelledby`
 * @property {string} content - content of attribute
 */
/**
 * @param {string} labelStr - content for `aria-label` or – if it starts with `#` – ID for `aria-labelledby`
 * @returns {LabelObj} Object with label attribute and its content
 */var a=function getAriaLabel(e){if(e!==null&&e!==void 0&&e.length){var t=e.startsWith("#");return{attribute:t?"aria-labelledby":"aria-label",content:t?e.substring(1):e}}};var d=function(){function Props(e,t,n){_classCallCheck(this,Props);this.id="".concat(n,"-result-").concat(e);this.class="".concat(n,"-result");this["data-result-index"]=e;this.role="option";e===t&&(this["aria-selected"]="true")}return _createClass(Props,[{key:"toString",value:function toString(){var e=this;return Object.keys(this).reduce((function(t,n){return"".concat(t," ").concat(n,'="').concat(e[n],'"')}),"")}}])}();var c=_createClass((function Autocomplete(e){var t=this;var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.search,r=n.onSubmit,c=r===void 0?function(){}:r,h=n.onUpdate,p=h===void 0?function(){}:h,f=n.baseClass,v=f===void 0?"autocomplete":f,b=n.autocorrect,y=b!==void 0&&b,m=n.autoSelect,L=n.getResultValue,P=L===void 0?function(e){return e}:L,g=n.renderResult,_=n.debounceTime,w=_===void 0?0:_,R=n.resultListLabel,S=n.submitOnEnter,x=S!==void 0&&S;_classCallCheck(this,Autocomplete);_defineProperty(this,"expanded",false);_defineProperty(this,"loading",false);_defineProperty(this,"position",{});_defineProperty(this,"resetPosition",true);_defineProperty(this,"initialize",(function(){t.root.style.position="relative";t.input.setAttribute("role","combobox");t.input.setAttribute("autocomplete","off");t.input.setAttribute("autocapitalize","off");t.autocorrect&&t.input.setAttribute("autocorrect","on");t.input.setAttribute("spellcheck","false");t.input.setAttribute("aria-autocomplete","list");t.input.setAttribute("aria-haspopup","listbox");t.input.setAttribute("aria-expanded","false");t.resultList.setAttribute("role","listbox");var e=a(t.resultListLabel);e&&t.resultList.setAttribute(e.attribute,e.content);t.resultList.style.position="absolute";t.resultList.style.zIndex="1";t.resultList.style.width="100%";t.resultList.style.boxSizing="border-box";t.resultList.id||(t.resultList.id=s("".concat(t.baseClass,"-result-list-")));t.input.setAttribute("aria-owns",t.resultList.id);document.body.addEventListener("click",t.handleDocumentClick);t.input.addEventListener("input",t.core.handleInput);t.input.addEventListener("keydown",t.core.handleKeyDown);t.input.addEventListener("focus",t.core.handleFocus);t.input.addEventListener("blur",t.core.handleBlur);t.resultList.addEventListener("mousedown",t.core.handleResultMouseDown);t.resultList.addEventListener("click",t.core.handleResultClick);t.updateStyle()}));_defineProperty(this,"destroy",(function(){document.body.removeEventListener("click",t.handleDocumentClick);t.input.removeEventListener("input",t.core.handleInput);t.input.removeEventListener("keydown",t.core.handleKeyDown);t.input.removeEventListener("focus",t.core.handleFocus);t.input.removeEventListener("blur",t.core.handleBlur);t.resultList.removeEventListener("mousedown",t.core.handleResultMouseDown);t.resultList.removeEventListener("click",t.core.handleResultClick);t.root=null;t.input=null;t.resultList=null;t.getResultValue=null;t.onUpdate=null;t.renderResult=null;t.core.destroy();t.core=null}));_defineProperty(this,"setAttribute",(function(e,n){t.input.setAttribute(e,n)}));_defineProperty(this,"setValue",(function(e){t.input.value=e?t.getResultValue(e):""}));_defineProperty(this,"renderResult",(function(e,n){return"<li ".concat(n,">").concat(t.getResultValue(e),"</li>")}));_defineProperty(this,"handleUpdate",(function(e,n){t.resultList.innerHTML="";e.forEach((function(e,i){var o=new d(i,n,t.baseClass);var r=t.renderResult(e,o);typeof r==="string"?t.resultList.insertAdjacentHTML("beforeend",r):t.resultList.insertAdjacentElement("beforeend",r)}));t.input.setAttribute("aria-activedescendant",n>-1?"".concat(t.baseClass,"-result-").concat(n):"");if(t.resetPosition){t.resetPosition=false;t.position=l(t.input,t.resultList);t.updateStyle()}t.core.checkSelectedResultVisible(t.resultList);t.onUpdate(e,n)}));_defineProperty(this,"handleShow",(function(){t.expanded=true;t.updateStyle()}));_defineProperty(this,"handleHide",(function(){t.expanded=false;t.resetPosition=true;t.updateStyle()}));_defineProperty(this,"handleLoading",(function(){t.loading=true;t.updateStyle()}));_defineProperty(this,"handleLoaded",(function(){t.loading=false;t.updateStyle()}));_defineProperty(this,"handleDocumentClick",(function(e){t.root.contains(e.target)||t.core.hideResults()}));_defineProperty(this,"updateStyle",(function(){t.root.dataset.expanded=t.expanded;t.root.dataset.loading=t.loading;t.root.dataset.position=t.position;t.resultList.style.visibility=t.expanded?"visible":"hidden";t.resultList.style.pointerEvents=t.expanded?"auto":"none";if(t.position==="below"){t.resultList.style.bottom=null;t.resultList.style.top="100%"}else{t.resultList.style.top=null;t.resultList.style.bottom="100%"}}));this.root=typeof e==="string"?document.querySelector(e):e;this.input=this.root.querySelector("input");this.resultList=this.root.querySelector("ul");this.baseClass=v;this.autocorrect=y;this.getResultValue=P;this.onUpdate=p;typeof g==="function"&&(this.renderResult=g);this.resultListLabel=R;this.submitOnEnter=x;var A=new o({search:i,autoSelect:m,setValue:this.setValue,setAttribute:this.setAttribute,onUpdate:this.handleUpdate,autocorrect:this.autocorrect,onSubmit:c,onShow:this.handleShow,onHide:this.handleHide,onLoading:this.handleLoading,onLoaded:this.handleLoaded,submitOnEnter:this.submitOnEnter});w>0&&(A.handleInput=u(A.handleInput,w));this.core=A;this.initialize()}));export{c as default};

